<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>KrishiMitra</title>
  <link rel="icon" type="image/png" href="favicon.png" />
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    :root {
      --color-low: #ff4d4d;
      --color-mid: #fdd835;
      --color-high: #00c853;
      --nav-height: 60px;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Poppins", sans-serif;
    }
    html {
      scroll-behavior: smooth;
    }
    body {
      background: #121212;
      color: #eee;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: var(--nav-height);
    }
    nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: var(--nav-height);
      background: #222;
      box-shadow: 0 2px 6px rgb(0 0 0 / 0.7);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
      z-index: 3000;
      color: #eee;
    }
    .nav-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .nav-left img {
      width: 48px;
      height: 48px;
    }
    .site-name {
      font-weight: 700;
      font-size: 1.8rem;
    }
    .nav-right {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .nav-home,
    .nav-farm,
    .nav-about {
      color: #eee;
      text-decoration: none;
      font-size: 1rem;
      font-weight: 600;
      padding: 8px 16px;
      border-radius: 8px;
      transition: background 0.3s ease;
      cursor: pointer;
    }
    .nav-home:hover,
    .nav-farm:hover,
    .nav-about:hover {
      background: #333;
    }
    main {
      margin-top: var(--nav-height);
      width: 100%;
      max-width: 600px;
      padding: 20px;
      text-align: center;
    }
    .main-logo-container {
      margin: 20px auto 10px;
      width: 150px;
      height: 150px;
      border-radius: 50%;
      background: #e1e7e433;
      box-shadow: 0 0 25px 8px #00c853aa;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }
    .main-logo-container img {
      width: 300px;
      height: 300px;
      object-fit: contain;
      filter: drop-shadow(0 0 30px  #c1fb03f9);
      border-radius: 80%;
      z-index: 2;
    }
    .main-site-name {
      font-size: 5.5rem;
      font-weight: 900;
      color: #00c853;
      margin-top: 30px;
      margin-bottom: 40px;
    }
    .quote-box {
      font-size: 1.2rem;
      color: #f7f0f0;
      margin: 30px auto;
      max-width: 600px;
      padding: 0 20px;
      font-style: italic;
    }
    .quote-author {
      text-align: right;
      font-size: 1rem;
      margin-top: 10px;
      font-style: normal;
      color: #ccc;
    }
    #farmBtn {
      padding: 14px 40px;
      font-size: 1.2rem;
      font-weight: 600;
      background: #00c853;
      border: none;
      border-radius: 12px;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin-bottom: 25px;
    }
    #farmBtn:hover {
      background: #008c2a;
    }
    #about {
      padding: 60px 20px;
      text-align: center;
      max-width: 800px;
      margin: 50px auto 0;
    }
    #about h2 {
      font-size: 2.5rem;
      color: #00c853;
      margin-bottom: 20px;
    }
    #about p {
      font-size: 1.1rem;
      line-height: 1.8;
      color: #eee;
    }
    #dashboardOverlay {
      position: fixed;
      top: var(--nav-height);
      left: 0;
      right: 0;
      bottom: 0;
      background: #1f1f1f;
      z-index: 2000;
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 40px 20px;
      overflow-y: auto;
    }
    #dashboardOverlay.active {
      display: flex;
    }
    #moisture-text {
      font-size: 1.5em;
      margin-bottom: 20px;
      font-weight: 500;
      color: #eee;
    }
    .gauge-container {
      position: relative;
      width: 100%;
      max-width: 350px;
      margin: 0 auto 30px;
    }
    #moistureChart {
      width: 100%;
    }
    .water-drop {
      position: absolute;
      top: 65%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 3.5em;
      color: #007bfff3;
    }
    .btn-group {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 10px;
      flex-wrap: wrap;
    }
    button.control-btn {
      padding: 12px 30px;
      font-size: 1em;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      min-width: 120px;
    }
    .on-btn {
      background: hsl(126, 92%, 56%);
      color: #fff;
    }
    .off-btn {
      background: hsl(3, 95%, 47%);
      color: #fff;
    }
    #pumpLabel {
      margin-top: 40px;
      font-weight: 600;
      color: #ccc;
    }
    #blinkOverlay {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 3000;
      display: none;
    }
    #blinkOverlay img {
      width: 150px;
      height: 150px;
      animation: blink 1s infinite;
      border-radius: 50%;
      filter: drop-shadow(0 0 10px #00c853cc);
    }
    @keyframes blink {
      0%, 50%, 100% { opacity: 1; }
      25%, 75% { opacity: 0; }
    }
    #backBtn {
      position: absolute;
      top: 20px;
      left: 20px;
      background: #333;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      z-index: 2100;
    }
    #backBtn:hover {
      background: #555;
    }
  </style>
</head>
<body>
  <nav>
    <div class="nav-left">
      <img src="favicon.png" alt="Logo" />
      <div class="site-name">KrishiMitra</div>
    </div>
    <div class="nav-right">
      <a href="#" class="nav-home">üè† Home</a>
      <a href="#farmBtn" class="nav-farm">üåæ Farm</a>
      <a href="#about" class="nav-about">‚ÑπÔ∏è About Us</a>
    </div>
  </nav>
  <main>
    <div class="main-logo-container">
      <img src="favicon.png" alt="Logo" />
    </div>
    <div class="main-site-name">KrishiMitra</div>
    <div class="quote-box">
      ‚ÄúWater is life's matter and matrix, mother and medium. There is no life without water.‚Äù
      <div class="quote-author">‚Äì Albert Szent-Gyorgyi</div>
    </div>
    <button id="farmBtn">FARM</button>
  </main>

  <div id="dashboardOverlay">
    <button id="backBtn">‚Üê Back</button>
    <div id="moisture-text">Soil Moisture: 0%</div>
    <div class="gauge-container">
      <canvas id="moistureChart"></canvas>
      <div class="water-drop">üíß</div>
    </div>
    <div class="btn-group">
      <button id="onBtn" class="control-btn on-btn">ON</button>
      <button id="offBtn" class="control-btn off-btn">OFF</button>
    </div>
    <div id="pumpSwitch" role="switch" aria-checked="false" tabindex="0"></div>
    <div id="pumpLabel">Pump OFF</div>
  </div>

  <div id="blinkOverlay">
    <img src="favicon.png" alt="Loading" />
  </div>
  <section id="about">
    <h2>About Us</h2>
    <p>
      KrishiMitra is a smart farming assistant designed to simplify irrigation management through real-time soil moisture monitoring and pump control. Our goal is to conserve water and empower farmers with technology. Built with Firebase and IoT, KrishiMitra bridges the gap between agriculture and innovation.
    </p>
  </section>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyB2-BreO-2a-iMt0eS2tV0g-TlLHPBBSMQ",
      authDomain: "krishi-ai-4e8c1.firebaseapp.com",
      databaseURL: "https://krishi-ai-4e8c1-default-rtdb.firebaseio.com",
      projectId: "krishi-ai-4e8c1",
      storageBucket: "krishi-ai-4e8c1.appspot.com",
      messagingSenderId: "405166456294",
      appId: "1:405166456294:web:68ac980b74ef12ed98aa27",
      measurementId: "G-CW85NCHZY3"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const ctx = document.getElementById("moistureChart").getContext("2d");
    const moistureChart = new Chart(ctx, {
      type: "doughnut",
      data: {
        labels: ["Moisture", "Dry"],
        datasets: [{
          data: [0, 100],
          backgroundColor: ["#00c853", "#444"],
          borderWidth: 0,
        }],
      },
      options: {
        responsive: true,
        rotation: -90,
        circumference: 180,
        cutout: "70%",
        animation: { animateRotate: true, duration: 800 },
        plugins: {
          tooltip: { enabled: false },
          legend: { display: false }
        }
      },
    });

    const dashboardOverlay = document.getElementById("dashboardOverlay");
    const farmBtn = document.getElementById("farmBtn");
    const backBtn = document.getElementById("backBtn");
    const moistureText = document.getElementById("moisture-text");
    const pumpSwitch = document.getElementById("pumpSwitch");
    const pumpLabel = document.getElementById("pumpLabel");
    const onBtn = document.getElementById("onBtn");
    const offBtn = document.getElementById("offBtn");

    farmBtn.addEventListener("click", () => dashboardOverlay.classList.add("active"));
    backBtn.addEventListener("click", () => dashboardOverlay.classList.remove("active"));
    document.querySelector(".nav-farm").addEventListener("click", (e) => {
      e.preventDefault();
      dashboardOverlay.classList.remove("active");
      window.scrollTo({
      top: 250,
      behavior: "smooth"
  });
    });
    document.querySelector(".nav-home").addEventListener("click", (e) => {
      e.preventDefault();
      dashboardOverlay.classList.remove("active");
      window.scrollTo({
      top: 0,
      behavior: "smooth"
  });
    });
    document.querySelector(".nav-about").addEventListener("click", (e) => {
      e.preventDefault();
      dashboardOverlay.classList.remove("active");
      window.scrollTo({
      top : 5000,
      behavior: "smooth"
  });
    });

    db.ref("moisture").on("value", (snapshot) => {
      const value = snapshot.val();
      if (typeof value === "number") {
        moistureText.innerText = `Soil Moisture: ${value}%`;
        moistureChart.data.datasets[0].data = [value, 100 - value];
        moistureChart.data.datasets[0].backgroundColor = value < 30 ? ["#ff4d4d", "#444"]
          : value < 60 ? ["#fdd835", "#444"]
          : ["#00c853", "#444"];
        moistureChart.update();
      }
    });

    function togglePump(state) {
      pumpSwitch.classList.toggle("active", state);
      pumpLabel.textContent = state ? "Pump ON" : "Pump OFF";
      pumpSwitch.setAttribute("aria-checked", state ? "true" : "false");
      db.ref("pump").set(state);
    }

    db.ref("pump").on("value", (snapshot) => {
      togglePump(Boolean(snapshot.val()));
    });
    db.ref("alert").on("value", snapshot => {
      if (snapshot.val() === true) {
        Swal.fire({
          title: '‚ö†Ô∏è Soil Alert!',
          text: 'Soil moisture is too low. Please water the plant.',
          icon: 'warning',
          confirmButtonText: 'OK'
        });
      }
    });

    pumpSwitch.addEventListener("click", () => {
      const currentState = pumpSwitch.classList.contains("active");
      togglePump(!currentState);
    });

    onBtn.addEventListener("click", () => togglePump(true));
    offBtn.addEventListener("click", () => togglePump(false));
  </script>
</body>
</html>
